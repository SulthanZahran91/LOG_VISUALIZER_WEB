<?xml version="1.0" encoding="UTF-8"?>
<!--
  PLC Log Visualizer Configuration File
  
  This is the centralized configuration for the air-gapped PLC Log Visualizer.
  Edit this file to customize server behavior without using environment variables.
  
  Changes take effect on next server restart.
-->
<PLCLogVisualizer>
  <!-- Server Configuration -->
  <Server>
    <!-- HTTP server port (default: 8089) -->
    <Port>8089</Port>
    
    <!-- Bind address: 0.0.0.0 for all interfaces, 127.0.0.1 for localhost only -->
    <BindAddress>0.0.0.0</BindAddress>
    
    <!-- Enable CORS (Cross-Origin Resource Sharing) -->
    <EnableCORS>true</EnableCORS>
    
    <!-- Allowed origins for CORS (use * for all, or comma-separated list) -->
    <AllowOrigins>*</AllowOrigins>
    
    <!-- Timeout settings (in seconds) -->
    <ReadTimeoutSeconds>30</ReadTimeoutSeconds>
    <WriteTimeoutSeconds>30</WriteTimeoutSeconds>
    <IdleTimeoutSeconds>120</IdleTimeoutSeconds>
    
    <!-- Maximum request body size (e.g., 2G, 500M, 1048576) -->
    <BodyLimit>2G</BodyLimit>
  </Server>
  
  <!-- Storage Configuration -->
  <Storage>
    <!-- Base data directory (relative to .exe location or absolute path) -->
    <DataDirectory>./data</DataDirectory>
    
    <!-- Subdirectories (relative to DataDirectory or absolute paths) -->
    <UploadsDirectory>./data/uploads</UploadsDirectory>
    <TempDirectory>./data/temp</TempDirectory>
    <ParsedDataDirectory>./data/parsed</ParsedDataDirectory>
    
    <!-- Maximum upload file size -->
    <MaxUploadSize>2G</MaxUploadSize>
    
    <!-- Enable persistent storage of parsed files -->
    <EnablePersistence>true</EnablePersistence>
  </Storage>
  
  <!-- Processing Configuration -->
  <Processing>
    <!-- Maximum concurrent parse operations -->
    <MaxConcurrentParses>3</MaxConcurrentParses>
    
    <!-- Session timeout in minutes (inactive sessions are cleaned up) -->
    <SessionTimeoutMinutes>30</SessionTimeoutMinutes>
    
    <!-- Cleanup interval in minutes (how often to check for expired sessions) -->
    <CleanupIntervalMinutes>5</CleanupIntervalMinutes>
    
    <!-- Enable gzip compression for API responses -->
    <EnableCompression>true</EnableCompression>
    
    <!-- Compression level: 1-9 (1=fast, 9=best compression) -->
    <CompressionLevel>5</CompressionLevel>
    
    <!-- Maximum memory per DuckDB session -->
    <MaxMemoryPerSession>1GB</MaxMemoryPerSession>
  </Processing>
  
  <!-- Security Configuration -->
  <Security>
    <!-- Allow users to delete uploaded files -->
    <AllowFileDeletion>true</AllowFileDeletion>
    
    <!-- Require authentication token for API access -->
    <RequireAuthentication>false</RequireAuthentication>
    
    <!-- Authentication token (only used if RequireAuthentication is true) -->
    <AuthToken></AuthToken>
    
    <!-- Allowed file extensions for upload (comma-separated) -->
    <AllowedFileTypes>.csv,.log,.txt,.mcs,.xml,.yaml,.yml,.gz,.zip</AllowedFileTypes>
  </Security>
  
  <!-- Advanced Configuration -->
  <Advanced>
    <!-- Log level: debug, info, warn, error -->
    <LogLevel>info</LogLevel>
    
    <!-- Enable HTTP request logging -->
    <EnableRequestLogging>true</EnableRequestLogging>
    
    <!-- Number of DuckDB threads (0 = auto) -->
    <DuckDBThreads>4</DuckDBThreads>
    
    <!-- DuckDB memory limit per connection -->
    <DuckDBMemoryLimit>1GB</DuckDBMemoryLimit>
    
    <!-- WebSocket maximum message size in KB -->
    <WebSocketMaxMessageSizeKB>65536</WebSocketMaxMessageSizeKB>
  </Advanced>
</PLCLogVisualizer>
